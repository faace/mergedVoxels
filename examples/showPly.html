<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>custom geometry</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://faace.github.io/aFrameByCode/dist/aFrameByCode.min.js"></script>
    <script src="./js/superTouch.js"></script>
    <!-- <script src="../dist/MergedVoxels.aframe.min.js"></script> -->
    <script src="../src/Voxels.js"></script>
    <script src="../src/mvPly2Map.js"></script>
    <script type="text/ply" src="../ply/demo1.ply"></script>
</head>

<body>
    <script>
        mvPly2Map.parsePlys(function (err, plys) {
            console.log(err, plys);
            AFRAME.registerComponent('line2', {
                schema: {
                    start: { default: '0 0 -5' },
                    end: { default: '0 10 -5' }
                },
                init: function () {
                    map = plys.demo1;
                    var textures = {
                        '#dd0000': 'floor',
                        // '#00ff00': 'floor3',
                        '#3366ff': 'floor3'
                    };
                    var el = this.el;
                    var colors = mvPly2Map.getAllColors(map);
                    console.log(colors);
                    var info = {
                        align: 'center bottom center',
                        map: map,
                        textures: textures,
                        opacities: {
                            '#dd0000': 0.5
                        },
                        // height: 0.5,
                        // center: { x: 0, y: 0, z: 0 }
                    }
                    new Voxels(info).run(function (error, mesh) {
                        el.setObject3D('mesh', mesh);
                    });
                }
            });
            AFRAME.createAScene({
                id: 'scene1',
                onInit: function (scene) {
                    scene.assets.addList({
                        'img#box': './img/box.png',
                        'img#floor': './img/floor2.jpg',
                        'img#floor3': './img/floor3.jpg',
                    });

                    var cameraEntity = scene.addAnEntity('a-entity', { camera: '', 'position': '0 1.6 0' });
                    cameraEntity.addAnEntity('a-cursor', '');

                    scene.addEntities({
                        'a-entity': {
                            line2: '',
                            position: " 0 0 -4",
                            // scale: '0.2 0.2 0.2',
                            'super-touch': '',
                        },
                        'a-sky': { color: "#ECECEC" },
                    });
                },
            });
            AFRAME.loadScene('scene1');
        });

    </script>
</body>

</html>